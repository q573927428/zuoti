# 币安自动做T交易系统

一个基于Nuxt 4和Vue 3的自动化交易系统，用于执行币安现货日内做T策略。

## 功能特性

- ✅ 实时监控ETH/USDT、BTC/USDT、BNB/USDT、SOL/USDT等交易对
- ✅ 基于振幅和趋势的智能交易策略
- ✅ 完整的保护机制（突破保护、跌破保护、超时保护）
- ✅ 响应式UI界面
- ✅ 状态持久化（跨天自动重置）
- ✅ 持久化订单数据
- ✅ 数据本地化存储
- ✅ 全自动运行（自动下单、监控、卖出、撤单）
- ✅ 前端可设置交易对、开启暂停系统、查看交易记录、显示收益和损失、年化收益

## 技术栈

- Nuxt 4
- Vue 3
- TypeScript
- Element Plus
- CCXT (加密货币交易库)
- Pinia (状态管理)

## 安装依赖

```bash
pnpm install
```

## 环境配置

`.env` 文件已配置币安模拟交易API密钥：
```bash
BINANCE_API_KEY=
BINANCE_SECRET=
```

## 币安模拟交易设置

在系统配置中可以切换真实交易和模拟交易：
- `isTestnet: true` - 使用币安模拟交易（默认）
- `isTestnet: false` - 使用币安真实交易

## 交易策略说明

### 核心参数
- **K线周期**: 15分钟
- **区间统计窗口**: 最近6小时（24根15分钟K线）
- **振幅过滤**: 仅当 (H - L) / L >= 1.5% 时允许交易（降低阈值，更容易触发）
- **交易对筛选**: 从多个交易对中选择振幅最大且符合条件的进行交易
- **交易逻辑**: 
  - 只要有交易对振幅超过1.5%，就选择振幅最大的交易对进行交易
  - 如果所有交易对振幅都不足1.5%，则当天不交易
  - **每天最多只能完成一次交易**（完成买入和卖出的完整流程后，当天不再交易）
- **趋势过滤**: 防止在明显的单边趋势中交易（趋势超过5%则过滤）
- **挂单价格**: 
  - BuyPrice = L + 0.12 * Range
  - SellPrice = H - 0.12 * Range
- **固定投入**: 每次交易固定100 USDT（可配置）

### 状态机
```
IDLE → BUY_ORDER_PLACED → BOUGHT → SELL_ORDER_PLACED → DONE → IDLE
```

### 保护机制
1. **突破保护**: 价格突破上界H时，撤销买单
2. **跌破保护**: 价格跌破下界L时，撤销买单
3. **超时保护**: 订单挂单1小时后未成交则撤单

## 启动系统

### 开发模式
```bash
pnpm dev
```

### 生产模式
```bash
pnpm build
pnpm preview
```

访问：http://localhost:3000

## 使用说明

### 1. 启动系统
运行 `pnpm dev` 后，打开浏览器访问 http://localhost:3000

### 2. 配置系统
在"系统配置"面板中：
- 选择是否使用模拟交易
- 设置投资金额（USDT）
- 调整振幅阈值
- 调整趋势过滤阈值

### 3. 开启自动交易
点击右上角的"自动交易开启"开关，系统将：
- 每60秒执行一次交易循环
- 自动分析市场振幅
- 自动寻找交易机会
- 自动下单、监控、卖出

### 4. 监控交易
在界面上可以实时查看：
- 交易统计（总交易次数、成功交易、总收益、年化收益率）
- 当前交易状态
- 实时振幅分析
- 交易记录

## 项目结构

```
zuoti/
├── app/
│   ├── pages/
│   │   └── index.vue          # 主界面
│   ├── stores/
│   │   └── trading.ts         # Pinia状态管理
│   └── app.vue
├── server/
│   ├── api/
│   │   └── trading/
│   │       ├── load.get.ts    # 加载数据API
│   │       ├── save.post.ts   # 保存数据API
│   │       ├── analyze.get.ts # 分析交易对API
│   │       └── order/
│   │           ├── create-buy.post.ts   # 创建买单API
│   │           ├── create-sell.post.ts  # 创建卖单API
│   │           ├── status.get.ts        # 查询订单状态API
│   │           └── cancel.post.ts       # 取消订单API
│   ├── tasks/
│   │   └── trading-bot.ts     # 交易机器人任务
│   └── utils/
│       ├── binance.ts         # 币安API封装
│       └── strategy.ts        # 交易策略逻辑
├── types/
│   └── trading.ts             # TypeScript类型定义
├── data/                      # 数据持久化目录
│   └── trading-data.json      # 交易数据文件
├── .env                       # 环境变量
└── nuxt.config.ts            # Nuxt配置
```

## 数据持久化

系统会自动将以下数据保存到 `data/trading-data.json`：
- 交易配置
- 交易状态
- 交易记录
- 统计数据

每次交易状态变更都会自动保存，确保数据不会丢失。

## 安全提示

⚠️ **重要提示**：
1. 首次使用建议先使用模拟交易测试
2. 真实交易前请确认API密钥权限设置正确
3. 建议设置合理的投资金额
4. 定期检查交易记录和收益情况
5. 注意币安API的请求频率限制

## 开发规范

1. 使用TypeScript进行开发
2. 遵循ESLint代码规范
3. 模块化组件化开发
4. 使用Pinia进行状态管理
5. 所有类型都需要明确定义

## 故障排除

### 问题1: 无法连接到币安API
- 检查网络连接
- 确认API密钥是否正确
- 检查是否使用了正确的测试网URL

### 问题2: 订单一直未成交
- 可能是价格设置不合理
- 市场波动不够
- 可以调整振幅阈值参数

### 问题3: 数据丢失
- 检查data目录是否有写入权限
- 查看控制台错误日志

## 后续优化方向

- [ ] 添加更多技术指标支持
- [ ] 支持更多交易对
- [ ] 添加风险控制参数
- [ ] 增加回测功能
- [ ] 优化UI界面
- [ ] 添加通知功能（邮件/Telegram）
- [ ] 支持多账户管理

## License

MIT
